test_that("PosteriorMean is equal to weighted component-specific posterior means", {
    skip("no compost yet")
  set.seed(1); z=rnorm(100,0,2); z.ash=ash(z,1, outputlevel=4); expect_equal(z.ash$PosteriorMean, colSums(z.ash$flash.data$comp_postprob * z.ash$flash.data$comp_postmean))
})

test_that("PosteriorSD squared is equal to weighted component mean2 minus posterior mean all squared", {
    skip("no compost yet")
  set.seed(1); z=rnorm(100,0,2); z.ash=ash(z,1, outputlevel=4,mixcompdist="normal")
  expect_equal(z.ash$PosteriorSD^2, colSums(z.ash$flash.data$comp_postprob * z.ash$flash.data$comp_postmean2)-z.ash$PosteriorMean^2)
})

test_that("comp_postmean for null component is 0", {
    skip("no compost yet")
  set.seed(1); z=rnorm(100,0,2); z.ash=ash(z,1, outputlevel=4,mixcompdist="normal")
  expect_equal(z.ash$flash.data$comp_postmean[1,],rep(0,100))
})

test_that("comp_postmean for missing data is 0", {
    skip("no compost yet")
  set.seed(1); z=rnorm(100,0,2); z.ash=ash(c(NA,z),1, outputlevel=4)
  expect_true(all(z.ash$flash.data$comp_postmean[,1]==0))
})

test_that("comp_postprob for missing data is fitted pi", {
    skip("no compost yet")
  set.seed(1); z=rnorm(100,0,2); z.ash=ash(c(NA,z),1, outputlevel=4)
  expect_true(all(z.ash$flash.data$comp_postprob[,1]==z.ash$fitted.g$pi))
})
